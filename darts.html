<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Darts Battle</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Darts scorebord voor Zeebulon en Ras Echt">
    <meta name="theme-color" content="#ffcc00">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Darts Battle">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        :root {
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --accent-color: #ffcc00;
            --player1-color: #3498db;
            --player2-color: #e74c3c;
            --text-color: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 500px;
            padding: 10px 15px;
            text-align: center;
            box-sizing: border-box;
        }

        h1 {
            font-size: 1.8rem;
            margin: 15px 0;
        }

        /* Setup Scherm */
        #setup {
            margin-top: 30px;
            padding: 20px;
        }
        #setup p {
            font-size: 1.2rem;
            margin-bottom: 20px;
        }
        .mode-btn {
            padding: 25px 30px;
            margin: 8px;
            font-size: 1.8rem;
            min-width: 100px;
            border-radius: 15px;
            border: none;
            background: var(--accent-color);
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            touch-action: manipulation;
        }
        .mode-btn:active {
            transform: scale(0.95);
            background: #e6b800;
        }

        /* Scorebord Layout */
        #game {
            display: none;
            width: 100%;
            padding-bottom: 20px;
        }
        .scoreboard {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .player-card {
            flex: 1;
            padding: 12px 8px;
            border-radius: 15px;
            background: var(--card-bg);
            border: 3px solid transparent;
            transition: all 0.3s ease;
        }
        .player-card.active {
            border-color: var(--accent-color);
            box-shadow: 0 0 20px rgba(255, 204, 0, 0.3);
        }
        .player-card h2 {
            margin: 0 0 8px 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }
        .score {
            font-size: 3rem;
            font-weight: bold;
            margin: 8px 0;
            line-height: 1;
        }
        .legs {
            font-size: 0.95rem;
            color: var(--accent-color);
            margin: 5px 0;
        }
        .checkout-advice {
            font-size: 0.75rem;
            color: #2ecc71;
            margin-top: 5px;
            min-height: 18px;
            font-weight: 500;
        }
        .checkout-advice.impossible { color: #e67e22; }
        .checkout-advice.too-high { color: #95a5a6; }

        /* Input sectie */
        .input-box {
            background: var(--card-bg);
            padding: 20px 15px;
            border-radius: 20px;
            margin-top: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        #turn-indicator {
            font-size: 1.2rem;
            margin: 0 0 15px 0;
        }
        
        input {
            width: 100%;
            padding: 20px;
            font-size: 3rem;
            text-align: center;
            border-radius: 15px;
            border: 3px solid #555;
            margin-bottom: 20px;
            background: #1a1a1a;
            color: var(--accent-color);
            font-weight: bold;
            box-sizing: border-box;
            letter-spacing: 2px;
        }
        
        /* Number Pad Styling */
        .numpad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 15px;
        }
        .num-btn {
            padding: 25px;
            font-size: 2rem;
            font-weight: bold;
            background: #3a3a3a;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.15s ease;
            touch-action: manipulation;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .num-btn:active {
            background: #4a4a4a;
            transform: scale(0.92);
        }
        .clear-btn {
            background: #e74c3c;
        }
        .clear-btn:active {
            background: #c0392b;
        }
        .backspace-btn {
            background: #f39c12;
        }
        .backspace-btn:active {
            background: #d68910;
        }
        
        .submit-btn {
            width: 100%;
            padding: 28px;
            font-size: 1.6rem;
            font-weight: bold;
            background: #2ecc71;
            color: white;
            border: none;
            border-radius: 15px;
            margin-top: 15px;
            cursor: pointer;
            transition: 0.2s;
            touch-action: manipulation;
            min-height: 80px;
        }
        .submit-btn:active {
            background: #27ae60;
            transform: scale(0.97);
        }
        
        .reset-btn {
            margin-top: 25px;
            padding: 15px;
            background: none;
            color: #888;
            border: none;
            text-decoration: underline;
            font-size: 1rem;
            cursor: pointer;
        }

        /* Prevent zoom on double tap */
        button {
            touch-action: manipulation;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>ðŸŽ¯ Darts Battle</h1>

    <div id="setup">
        <p>Kies je startscore:</p>
        <button class="mode-btn" onclick="selectScore(101)">101</button>
        <button class="mode-btn" onclick="selectScore(301)">301</button>
        <button class="mode-btn" onclick="selectScore(501)">501</button>
    </div>

    <div id="player-select" style="display: none;">
        <p style="font-size: 1.3rem; margin-bottom: 25px;">Wie begint?</p>
        <button class="mode-btn" onclick="startGame(0)" style="width: 200px; margin: 15px;">Zeebulon</button>
        <button class="mode-btn" onclick="startGame(1)" style="width: 200px; margin: 15px;">Ras Echt</button>
    </div>

    <div id="game">
        <div class="scoreboard">
            <div id="card1" class="player-card active">
                <h2>Zeebulon</h2>
                <div class="score" id="score1">501</div>
                <div class="legs" id="legs1">Legs: 0</div>
                <div class="checkout-advice" id="checkout1"></div>
            </div>
            <div id="card2" class="player-card">
                <h2>Ras Echt</h2>
                <div class="score" id="score2">501</div>
                <div class="legs" id="legs2">Legs: 0</div>
                <div class="checkout-advice" id="checkout2"></div>
            </div>
        </div>

        <div class="input-box">
            <p id="turn-indicator">Beurt: <b>Zeebulon</b></p>
            <input type="text" id="points-input" readonly placeholder="0" style="font-size: 2.5rem; margin-bottom: 20px;">
            
            <div class="numpad">
                <button class="num-btn" onclick="addDigit('1')">1</button>
                <button class="num-btn" onclick="addDigit('2')">2</button>
                <button class="num-btn" onclick="addDigit('3')">3</button>
                <button class="num-btn" onclick="addDigit('4')">4</button>
                <button class="num-btn" onclick="addDigit('5')">5</button>
                <button class="num-btn" onclick="addDigit('6')">6</button>
                <button class="num-btn" onclick="addDigit('7')">7</button>
                <button class="num-btn" onclick="addDigit('8')">8</button>
                <button class="num-btn" onclick="addDigit('9')">9</button>
                <button class="num-btn clear-btn" onclick="clearInput()">C</button>
                <button class="num-btn" onclick="addDigit('0')">0</button>
                <button class="num-btn backspace-btn" onclick="backspace()">âŒ«</button>
            </div>
            
            <button class="submit-btn" onclick="processTurn()">Bevestig & Volgende Speler</button>
        </div>

        <button class="reset-btn" onclick="location.reload()">Match stoppen</button>
    </div>
</div>

<script>
    let scores = [0, 0]; // Index 0 is Zeebulon, Index 1 is Ras Echt
    const playerNames = ["Zeebulon", "Ras Echt"];
    let legs = [0, 0];
    let startScore = 0;
    let currentPlayer = 0; // 0 of 1
    let selectedScore = 0;

    // Comprehensive checkout table with optimal dart combinations
    const checkouts = {
        2: "D1", 3: "1, D1", 4: "D2", 5: "1, D2", 6: "D3", 7: "3, D2", 8: "D4",
        9: "1, D4", 10: "D5", 11: "3, D4", 12: "D6", 13: "5, D4", 14: "D7",
        15: "7, D4", 16: "D8", 17: "9, D4", 18: "D9", 19: "3, D8", 20: "D10",
        21: "5, D8", 22: "D11", 23: "7, D8", 24: "D12", 25: "9, D8", 26: "D13",
        27: "11, D8", 28: "D14", 29: "13, D8", 30: "D15", 31: "15, D8", 32: "D16",
        33: "1, D16", 34: "D17", 35: "3, D16", 36: "D18", 37: "5, D16", 38: "D19",
        39: "7, D16", 40: "D20", 41: "9, D16", 42: "10, D16", 43: "3, D20", 44: "12, D16",
        45: "13, D16", 46: "6, D20", 47: "15, D16", 48: "16, D16", 49: "9, D20", 50: "Bull",
        51: "11, D20", 52: "12, D20", 53: "13, D20", 54: "14, D20", 55: "15, D20", 56: "16, D20",
        57: "17, D20", 58: "18, D20", 59: "19, D20", 60: "20, D20",
        61: "T15, D8", 62: "T10, D16", 63: "T13, D12", 64: "T16, D8", 65: "T19, D4",
        66: "T10, D18", 67: "T17, D8", 68: "T20, D4", 69: "T19, D6", 70: "T18, D8",
        71: "T13, D16", 72: "T16, D12", 73: "T19, D8", 74: "T14, D16", 75: "T17, D12",
        76: "T20, D8", 77: "T19, D10", 78: "T18, D12", 79: "T13, D20", 80: "T20, D10",
        81: "T19, D12", 82: "Bull, D16", 83: "T17, D16", 84: "T20, D12", 85: "T15, D20",
        86: "T18, D16", 87: "T17, D18", 88: "T16, D20", 89: "T19, D16", 90: "T18, D18",
        91: "T17, D20", 92: "T20, D16", 93: "T19, D18", 94: "T18, D20", 95: "T19, D19",
        96: "T20, D18", 97: "T19, D20", 98: "T20, D19", 99: "T19, Bull", 100: "T20, D20",
        101: "T17, Bull", 102: "T20, D21", 103: "T19, D23", 104: "T18, Bull", 105: "T19, D24",
        106: "T20, D23", 107: "T19, Bull", 108: "T20, D24", 109: "T20, D24.5", 110: "T20, Bull",
        111: "T19, T12, D9", 112: "T20, T12, D8", 113: "T19, T16, D8", 114: "T20, T14, D12",
        115: "T19, T18, D4", 116: "T20, T16, D8", 117: "T20, T17, D6", 118: "T20, T18, D4",
        119: "T19, T12, D16", 120: "T20, 20, D20", 121: "T20, T17, D5", 122: "T18, T18, D7",
        123: "T19, T16, D9", 124: "T20, T16, D10", 125: "T18, T19, D7", 126: "T19, T19, D6",
        127: "T20, T17, D8", 128: "T18, T14, D16", 129: "T19, T16, D12", 130: "T20, T18, D8",
        131: "T20, T13, D16", 132: "Bull, Bull, D16", 133: "T20, T19, D8", 134: "T20, T14, D16",
        135: "Bull, Bull, D17.5", 136: "T20, T20, D8", 137: "T20, T19, D10", 138: "T20, T18, D12",
        139: "T20, T13, D20", 140: "T20, T20, D10", 141: "T20, T19, D12", 142: "T20, T14, Bull",
        143: "T20, T17, D16", 144: "T20, T20, D12", 145: "T20, T15, Bull", 146: "T20, T18, D16",
        147: "T20, T17, D18", 148: "T20, T20, D14", 149: "T20, T19, D16", 150: "T20, T18, D18",
        151: "T20, T17, D20", 152: "T20, T20, D16", 153: "T20, T19, D18", 154: "T20, T18, D20",
        155: "T20, T19, D19", 156: "T20, T20, D18", 157: "T20, T19, D20", 158: "T20, T20, D19",
        160: "T20, T20, D20", 161: "T20, T17, Bull", 164: "T20, T18, Bull", 167: "T20, T19, Bull",
        170: "T20, T20, Bull"
    };

    // Impossible checkouts (can't finish in 3 darts)
    const impossibleCheckouts = [159, 162, 163, 165, 166, 168, 169];

    function getCheckoutAdvice(score) {
        if (score > 170) {
            return { text: "Te hoog voor checkout", className: "too-high" };
        }
        if (impossibleCheckouts.includes(score)) {
            return { text: "Geen directe checkout", className: "impossible" };
        }
        if (checkouts[score]) {
            return { text: "âœ“ " + checkouts[score], className: "" };
        }
        return { text: "", className: "" };
    }

    function selectScore(val) {
        selectedScore = val;
        document.getElementById('setup').style.display = 'none';
        document.getElementById('player-select').style.display = 'block';
    }

    function startGame(startingPlayer) {
        startScore = selectedScore;
        scores = [selectedScore, selectedScore];
        legs = [0, 0];
        currentPlayer = startingPlayer;
        
        updateDisplay();
        document.getElementById('player-select').style.display = 'none';
        document.getElementById('game').style.display = 'block';
    }

    function processTurn() {
        const input = document.getElementById('points-input');
        const points = parseInt(input.value);

        if (isNaN(points) || points < 0 || points > 180) {
            alert("Voer een geldige score in (0-180)");
            input.value = '';
            return;
        }

        let currentScore = scores[currentPlayer];
        let newScore = currentScore - points;

        // DARTS LOGICA
        if (newScore === 0) {
            // Leg Gewonnen!
            legs[currentPlayer]++;
            alert(playerNames[currentPlayer] + " wint de leg!");
            
            if (legs[currentPlayer] === 3) {
                alert("MATCH OVER! " + playerNames[currentPlayer] + " wint de wedstrijd!");
                location.reload();
                return;
            }
            // Reset scores voor volgende leg
            scores = [startScore, startScore];
        } else if (newScore < 0 || newScore === 1) {
            alert("Bust! Score blijft " + currentScore);
            // Bij Bust wisselt de beurt wel
        } else {
            scores[currentPlayer] = newScore;
        }

        // Wissel van speler
        currentPlayer = currentPlayer === 0 ? 1 : 0;
        
        input.value = '';
        updateDisplay();
    }

    function updateDisplay() {
        document.getElementById('score1').innerText = scores[0];
        document.getElementById('score2').innerText = scores[1];
        document.getElementById('legs1').innerText = "Legs: " + legs[0];
        document.getElementById('legs2').innerText = "Legs: " + legs[1];
        
        // Update checkout advice for both players
        const checkout1 = getCheckoutAdvice(scores[0]);
        const checkout2 = getCheckoutAdvice(scores[1]);
        
        const checkout1El = document.getElementById('checkout1');
        const checkout2El = document.getElementById('checkout2');
        
        checkout1El.innerText = checkout1.text;
        checkout1El.className = "checkout-advice " + checkout1.className;
        
        checkout2El.innerText = checkout2.text;
        checkout2El.className = "checkout-advice " + checkout2.className;
        
        // Update visuele indicatie wie aan de beurt is
        document.getElementById('card1').className = "player-card " + (currentPlayer === 0 ? "active" : "");
        document.getElementById('card2').className = "player-card " + (currentPlayer === 1 ? "active" : "");
        document.getElementById('turn-indicator').innerHTML = "Beurt: <b>" + playerNames[currentPlayer] + "</b>";
    }
    
    // Number pad functions
    function addDigit(digit) {
        const input = document.getElementById('points-input');
        const currentValue = input.value;
        
        // Prevent entering more than 3 digits (max score is 180)
        if (currentValue.length >= 3) return;
        
        input.value = currentValue + digit;
    }
    
    function clearInput() {
        document.getElementById('points-input').value = '';
    }
    
    function backspace() {
        const input = document.getElementById('points-input');
        input.value = input.value.slice(0, -1);
    }
    // Register Service Worker for PWA
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('/service-worker.js')
                .then(registration => console.log('Service Worker registered'))
                .catch(err => console.log('Service Worker registration failed:', err));
        });
    }
</script>

</body>
</html>